/*
 * File: app/controller/CollectionController.js
 *
 * This file was generated by Sencha Architect
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.3.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.3.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Recccords.controller.CollectionController', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            collectionContainer: '#collectionContainer',
            collectionItems: '#collectionItems',
            detailContainer: '#detailContainer',
            viewport: '#viewport'
        },

        control: {
            "dataview": {
                itemtap: 'onDataviewItemTap'
            }
        }
    },

    onDataviewItemTap: function(dataview, index, target, record, e, eOpts) {
        console.log("dataviewitemtap" + target._record.data.discogsId);

        var me = this;
        successCB = function(results) {
            console.log("detailcallback");
            console.log(results);

            // create and set the data
            var detailContainer = Ext.create('Recccords.view.DetailContainer', {});
            detailContainer.setData(results);

            var viewport = me.getViewport();
            viewport.add(detailContainer);

            // this will trigger activate on DetaiLContainer ad DetailContainerController
            Ext.Viewport.setActiveItem(detailContainer);


        };
        failCB = function(result){
            console.log("getCOllection failed error : "+result.error);
        };
        me.successCB = successCB;
        getRecordDiscogsAndUserData(target._record.data.discogsId,me.successCB);
    }

});